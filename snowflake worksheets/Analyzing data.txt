USE WAREHOUSE COMPUTE_WH;


-- Data exploration:

-- Get the structure of a tables

DESCRIBE TABLE COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL;

-- Make a quick look at the data

SELECT * FROM COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL LIMIT 5;

-- Count the number of rows in a table

SELECT COUNT(*) AS NUMBER_OF_ROWS FROM COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL;

-- Find the unique values in a columns

SELECT DISTINCT DATE FROM COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL
ORDER BY DATE;

-- Calculate aggregate statistics for a columns

SELECT COUNTRY_REGION, SUM(CASES) AS TOTAL_CASES, SUM(DEATHS) AS TOTAL_DEATHS FROM COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL
GROUP BY COUNTRY_REGION
ORDER BY TOTAL_CASES DESC;

-- Find rows with missing values in columns

SELECT * FROM COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL WHERE CASES IS NULL;

-- Count the number of missing values in a columns

SELECT COUNT(*) AS MISSING_VALUES FROM COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL
WHERE CASES IS NULL;


-- Pattern identification:

-- Find the date with the highest number of cases

SELECT DATE, MAX(CASES) AS MAX_CASES 
FROM COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL 
GROUP BY DATE
ORDER BY MAX_CASES DESC
LIMIT 1;

-- Find the average number of cases per month

SELECT DATE_PART('MONTH', DATE) AS MONTH, ROUND(AVG(CASES),0) AS AVG_CASES 
FROM COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL 
GROUP BY MONTH;

-- Find the correlation between cases and deaths

SELECT CORR(CASES, DEATHS) AS CASES_DEATHS_CORRELATION
FROM COVID19_EPIDEMIOLOGICAL_DATA.PUBLIC.ECDC_GLOBAL;